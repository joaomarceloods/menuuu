<div><%= link_to "Back to menus", [:private, :menus] %></div>
<div><%= link_to "Delete menu", [:private, @menu], data: { turbo_method: :delete, turbo_confirm: "Delete #{@menu.name}?" } %></div>

<br/>

<%= turbo_frame_tag dom_id(@menu, :publish) do %>
  <%= form_for @menu, url: [:private, @menu], html: { oninput: "this.requestSubmit()" } do |f| %>
    <%= f.check_box :published %>
    <%= f.label :published %>
  <% end %>
<% end %>

<%= turbo_frame_tag dom_id(@menu, :edit) do %>
  <%= form_for @menu, url: [:private, @menu], html: { oninput: "this.requestSubmit()" } do |f| %>
    <%= f.text_field :name, placeholder: "Menu Name", autocomplete: :off, style: "font-size: 2em; margin-bottom: 1em;" %>
  <% end %>
<% end %>

<div id="menu_items" data-controller="sortable-menu-sections">
  <% @menu.menu_sections.order(:position).each do |menu_section| %>
    <%= tag.div data: { sortable_menu_sections_update_url: private_menu_section_path(menu_section) } do %>
      <%= render "private/menu_sections/edit_form", menu_section: menu_section %>

      <%= tag.div data: { controller: "sortable-menu-items", sortable_menu_items_menu_section_id: menu_section.id } do %>
        <% menu_section.menu_items.order(:position).each do |menu_item| %>
          <%= render "private/menu_items/edit_form", menu_item: menu_item %>
          <%= button_to "Add item", private_menu_items_path %>
        <% end %>
      <% end %>

      <%#= render "private/menu_items/new_form", menu_item: menu_section.menu_items.build %>
    <% end %>
  <% end %>
</div>
